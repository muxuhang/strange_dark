{"componentChunkName":"component---src-templates-blog-post-js","path":"/ReactNative/ios极光推送/","result":{"data":{"site":{"siteMetadata":{"title":""}},"markdownRemark":{"id":"79b1ca6f-0c9a-58bb-a55f-5ee567095512","excerpt":"ios 推送集成 https://docs.jiguang.cn//jpush/client/iOS/ios_guide_new/ 导入 SDK 如使用 Xcode 8 及以上环境开发，请开启 Application Target 的 Capabilities->Push Notifications…","html":"<h3>ios 推送集成</h3>\n<p><a href=\"https://docs.jiguang.cn//jpush/client/iOS/ios_guide_new/\">https://docs.jiguang.cn//jpush/client/iOS/ios_guide_new/</a></p>\n<h4>导入 SDK</h4>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">pod <span class=\"token string\">'JCore'</span> <span class=\"token comment\">// 可选项，也可由pod 'JPush'自动获取</span>\npod <span class=\"token string\">'JPush'</span> <span class=\"token comment\">// 必选项</span>\n<span class=\"token comment\">//安装指定版本</span>\npod <span class=\"token string\">'JCore'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2.1.4'</span>    <span class=\"token comment\">// 可选项，也可由pod 'JPush'自动获取</span>\npod <span class=\"token string\">'JPush'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3.2.6'</span>    <span class=\"token comment\">// 必选项</span>\n注：如果无法导入最新版本，请执行 pod repo update master 这个命令来升级本机的 pod 库，然后重新 pod <span class=\"token string\">'JPush'</span></code></pre></div>\n<p>如使用 Xcode 8 及以上环境开发，请开启 Application Target 的 Capabilities->Push Notifications 选项，如图\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5986be0670e7250c767bab5b48aca1ac/efa1a/jgPush1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABSUlEQVR42l2RW0vDQBCF87fbQunvEQTxRZ8EH0opFn2wlWqb5t61m2RJc+umuRx3RwLRgeHMsrMfZ2aN2/tH3Nw9wA5ClFWNMBYosxSxyOGFJfLiAiEE8jyHlBJpmiLLMjprLYqC7nXMZjMYq/kCr4slfPOAyLXQJhGkuYbYf2LnJiguEmVZoG1bdF1H2jTNn6yqioDT6RTGevWGp+UHbMeH6wX42plg5p5c9iFrIM1y5MqRdtXD+6zrmvomkwmM5/kGL1sGPzjC8Rgs9wju2EDXUpN2UCqXJ86RJAmNx1WtR/0PHI1GMOztFt5JwGdcZQjvO0LoOkDbQKpRGGOIoohAcRzjfD7T/q7XK0GGwPF4DMPdvNP+AtPE8fCroX3QnajUI/0J/QdomHan4UNgX5NDy3LguT58lYEfkHIeUuMw+vH6GO5x6PAHgLwLmjKB21IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jgPush1\"\n        title=\"jgPush1\"\n        src=\"/static/5986be0670e7250c767bab5b48aca1ac/fcda8/jgPush1.png\"\n        srcset=\"/static/5986be0670e7250c767bab5b48aca1ac/12f09/jgPush1.png 148w,\n/static/5986be0670e7250c767bab5b48aca1ac/e4a3f/jgPush1.png 295w,\n/static/5986be0670e7250c767bab5b48aca1ac/fcda8/jgPush1.png 590w,\n/static/5986be0670e7250c767bab5b48aca1ac/efc66/jgPush1.png 885w,\n/static/5986be0670e7250c767bab5b48aca1ac/c83ae/jgPush1.png 1180w,\n/static/5986be0670e7250c767bab5b48aca1ac/efa1a/jgPush1.png 2040w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>全局配置 info.plist</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>key<span class=\"token operator\">></span>NSAppTransportSecurity<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>key<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>dict<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>key<span class=\"token operator\">></span>NSAllowsArbitraryLoads<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>key<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token boolean\">true</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dict<span class=\"token operator\">></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 引入 JPush 功能所需头文件</span>\n#<span class=\"token keyword\">import</span> <span class=\"token string\">\"JPUSHService.h\"</span>\n<span class=\"token comment\">// iOS10 注册 APNs 所需头文件</span>\n#ifdef NSFoundationVersionNumber_iOS_9_x_Max\n#<span class=\"token keyword\">import</span> <span class=\"token operator\">&lt;</span>UserNotifications<span class=\"token operator\">/</span>UserNotifications<span class=\"token punctuation\">.</span>h<span class=\"token operator\">></span>\n#endif\n<span class=\"token comment\">// 如果需要使用 idfa 功能所需要引入的头文件（可选）</span>\n#<span class=\"token keyword\">import</span> <span class=\"token operator\">&lt;</span>AdSupport<span class=\"token operator\">/</span>AdSupport<span class=\"token punctuation\">.</span>h<span class=\"token operator\">></span></code></pre></div>\n<h5>AppDelegate</h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token keyword\">interface</span> <span class=\"token class-name\">AppDelegate</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>JPUSHRegisterDelegate<span class=\"token operator\">></span>\n@end</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e21a6cfc81657d37478485471761152b/a83dd/jgPush2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 104.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAACqUlEQVR42p1UiY7aMBT0//9bK7V0OXKRiySQO4GEAGHqebtGUS+tGmkY289+Hr8D5boOfqy+w7EtQRj4+Pz3/AWAqvsr0rJDWrQ41RdkVY+yu2qMKNoBVT/JPG8uMpd1jeZyRzfOaBfgXB3bCc6hxjY4wUtb2HGJbVhgFxVY+yc4SQMrrvDNirFyE7FtgxxBMSDtZiTtA6kGOeseUJu0x5egxTa7wMkHeMUo+N9POZ4Pzw9hux4sx8M+iODtfZxOJ1RVJUzUdS1clqWgKAqxk82ey+UCVVWl3lyhbVs0TS3jRh++3++Y5xkPjXmBx+Mhtj+BNnW73XA4HJDnOYZx/HDcyO1Eo+dLVcMw/NOposztdgvHcRCGIfb7PTzPE7YtS2ybzQaWHruuiyAIkGWZXEoYAQI9VqNWlSQJ3t7e5ACd2bYtqg2Ox+OL6YxK+74XZ13XCZuxummZpX4aFdARlRklPEgYZwwLQad/e7qariOqIkeR66yWhXCpQdVpmopDjo0yMsH4TtOE6/X6Aueq1J0Q5h2y+qy7YNAdcUak50wQE8ZNBpybw1TzfD4F5pv1WK38HF+9HCvdFfahhHdssY4q9OcBV+2USePz6ITMmJPNOpnxPJ/P7wqTQ4z8mCJLE8RRCM6TOJJC5kaTQR7gGgNvErEccw8vVb3eeNKBLnSdvd8+Cn/6/+bj2QQLXzEWzPB6vZagM5tsI1MiZK6zsJlhU+BMGG18BZVRBKEYB5YFD3MTi5vjOI4RRdGLuUabyTjXCdPn5jI1TTe5KdSHeNOyX5dssMy4galB1rR0CouZoELf99/bThf5brd7tSOLnczXUBUVUQiTtSwvxR+Tfm7kMxhT9jYd8omME+3E45fOMM4MKyOZ6TeJEAU68NJmeo225eHfcXvxT8mBPsdBzFODAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jgPush2\"\n        title=\"jgPush2\"\n        src=\"/static/e21a6cfc81657d37478485471761152b/fcda8/jgPush2.png\"\n        srcset=\"/static/e21a6cfc81657d37478485471761152b/12f09/jgPush2.png 148w,\n/static/e21a6cfc81657d37478485471761152b/e4a3f/jgPush2.png 295w,\n/static/e21a6cfc81657d37478485471761152b/fcda8/jgPush2.png 590w,\n/static/e21a6cfc81657d37478485471761152b/efc66/jgPush2.png 885w,\n/static/e21a6cfc81657d37478485471761152b/c83ae/jgPush2.png 1180w,\n/static/e21a6cfc81657d37478485471761152b/a83dd/jgPush2.png 1482w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4>AppDelegate.m</h4>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>application<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UIApplication <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>application\n<span class=\"token literal-property property\">didRegisterForRemoteNotificationsWithDeviceToken</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>NSData <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>deviceToken <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/// Required - 注册 DeviceToken</span>\n  <span class=\"token punctuation\">[</span>JPUSHService registerDeviceToken<span class=\"token operator\">:</span>deviceToken<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>application<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UIApplication <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>application didFailToRegisterForRemoteNotificationsWithError<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>NSError <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>error <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//Optional</span>\n  <span class=\"token function\">NSLog</span><span class=\"token punctuation\">(</span>@<span class=\"token string\">\"did Fail To Register For Remote Notifications With Error: %@\"</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// iOS 12 Support</span>\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>jpushNotificationCenter<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UNUserNotificationCenter <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>center openSettingsForNotification<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UNNotification <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>notification<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>notification <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">[</span>notification<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>trigger isKindOfClass<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>UNPushNotificationTrigger <span class=\"token keyword\">class</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//从通知界面直接进入应用</span>\n  <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//从通知设置界面进入应用</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// iOS 10 Support</span>\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>jpushNotificationCenter<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UNUserNotificationCenter <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>center willPresentNotification<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UNNotification <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>notification withCompletionHandler<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">^</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>NSInteger<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>completionHandler <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Required</span>\n  NSDictionary <span class=\"token operator\">*</span> userInfo <span class=\"token operator\">=</span> notification<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">.</span>userInfo<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>notification<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>trigger isKindOfClass<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>UNPushNotificationTrigger <span class=\"token keyword\">class</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span>JPUSHService handleRemoteNotification<span class=\"token operator\">:</span>userInfo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">completionHandler</span><span class=\"token punctuation\">(</span>UNNotificationPresentationOptionAlert<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 需要执行这个方法，选择是否提醒用户，有 Badge、Sound、Alert 三种类型可以选择设置</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// iOS 10 Support</span>\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>jpushNotificationCenter<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UNUserNotificationCenter <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>center didReceiveNotificationResponse<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UNNotificationResponse <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>response withCompletionHandler<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">^</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>completionHandler <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Required</span>\n  NSDictionary <span class=\"token operator\">*</span> userInfo <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>notification<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">.</span>userInfo<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>response<span class=\"token punctuation\">.</span>notification<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>trigger isKindOfClass<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>UNPushNotificationTrigger <span class=\"token keyword\">class</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span>JPUSHService handleRemoteNotification<span class=\"token operator\">:</span>userInfo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">completionHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 系统要求执行这个方法</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>application<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UIApplication <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>application didReceiveRemoteNotification<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>NSDictionary <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>userInfo fetchCompletionHandler<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">^</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>UIBackgroundFetchResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>completionHandler <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Required, iOS 7 Support</span>\n  <span class=\"token punctuation\">[</span>JPUSHService handleRemoteNotification<span class=\"token operator\">:</span>userInfo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">completionHandler</span><span class=\"token punctuation\">(</span>UIBackgroundFetchResultNewData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>application<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>UIApplication <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>application didReceiveRemoteNotification<span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>NSDictionary <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>userInfo <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Required, For systems with less than or equal to iOS 6</span>\n  <span class=\"token punctuation\">[</span>JPUSHService handleRemoteNotification<span class=\"token operator\">:</span>userInfo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"/91189b7a9e463fa34e7ea5820084c80f/CPushManager.h\">CPushManager.h 下载</a></p>\n<p><a href=\"/367bf9944f57c52e7c8f3ff1a56199f2/CPushManager.m\">CPushManager.m 下载</a></p>","frontmatter":{"title":"RN ios极光推送","date":"April 02, 2022","description":"react-native 极光推送 ios"}}},"pageContext":{"slug":"/ReactNative/ios极光推送/","previous":{"fields":{"slug":"/Html/视频切片上传/"},"frontmatter":{"title":"视频分片上传"}},"next":{"fields":{"slug":"/ReactNative/android极光推送/"},"frontmatter":{"title":"RN android极光推送"}}}},"staticQueryHashes":["1246554614","2841359383"]}