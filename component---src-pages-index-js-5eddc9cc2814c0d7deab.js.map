{"version":3,"sources":["webpack:///./src/pages/index.js","webpack:///./src/pages/index.module.css"],"names":["BlogIndex","props","data","location","siteTitle","site","siteMetadata","title","posts","allMarkdownRemark","edges","directories","allDirectory","nodes","useState","totalList","setTotalList","list","setList","window","hm","document","createElement","src","s","getElementsByTagName","parentNode","insertBefore","current","setCurrent","search","setSearch","useEffect","result","filter","e","node","frontmatter","description","classify","setClassify","parent","relativeDirectory","slice","scrollTop","setScrollTop","addEventListener","documentElement","local","localStorage","getItem","parseInt","local1","setItem","toString","className","styles","search_box","style","position","backgroundColor","padding","top","maxWidth","flex","placeholder","onKeyUp","keyCode","target","value","marginLeft","minWidth","onChange","Option","map","item","index","name","key","height","console","log","fields","slug","list_item","boxShadow","to","date","dangerouslySetInnerHTML","__html","excerpt","margin","pageSize","total","length","module","exports"],"mappings":"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","file":"component---src-pages-index-js-5eddc9cc2814c0d7deab.js","sourcesContent":["import React, { useEffect, useState } from \"react\"\nimport { Link, graphql } from \"gatsby\"\nimport Layout from \"../components/layout\"\nimport styles from './index.module.css'\nimport { Input, Pagination, Select } from \"antd\"\nconst BlogIndex = (props) => {\n  const { data, location } = props\n  const siteTitle = data.site.siteMetadata.title\n  const posts = data.allMarkdownRemark.edges\n  const directories = data.allDirectory.nodes\n  const [totalList, setTotalList] = useState([])\n  const [list, setList] = useState([])\n  if (typeof window !== 'undefined') {\n    var hm = document.createElement(\"script\");\n    hm.src = \"https://s9.cnzz.com/z_stat.php?id=1278835659&web_id=1278835659\";\n    var s = document.getElementsByTagName(\"script\")[0];\n    s.parentNode.insertBefore(hm, s);\n  }\n  const [current, setCurrent] = useState(1)\n  const [search, setSearch] = useState('')\n  const pageSize = 7\n  useEffect(() => {\n    const result = posts.filter(e => {\n      return e.node.frontmatter.title.search(search) >= 0 ||\n        e.node.frontmatter.description.search(search) >= 0\n    })\n    setTotalList(result)\n  }, [search])\n  const [classify, setClassify] = useState('')\n  useEffect(() => {\n    setCurrent(1)\n    const result = posts.filter(e => {\n      return e.node.parent.relativeDirectory === classify || classify == ''\n    })\n    setTotalList(result)\n  }, [classify])\n  useEffect(() => {\n    const result = totalList.slice((current - 1) * pageSize, (current) * pageSize)\n    setList(result)\n  }, [current, totalList])\n\n  const [scrollTop, setScrollTop] = useState(0)\n  useEffect(() => {\n    window.addEventListener('scroll', (e) => {\n      const scrollTop = document.documentElement.scrollTop\n      setScrollTop(scrollTop)\n    })\n    const local = localStorage.getItem('current')\n    if (local != 1) {\n      setCurrent(parseInt(local) || 1)\n    }\n    const local1 = localStorage.getItem('classify')\n    if (local1) {\n      setClassify(local1 || '')\n    }\n  }, [])\n  useEffect(() => {\n    localStorage.setItem('current', current.toString())\n  }, [current])\n  useEffect(() => {\n    localStorage.setItem('classify', classify.toString())\n  }, [classify])\n  const renderSearch = () => {\n    return (\n      <div>\n        <div className={styles.search_box} style={\n          scrollTop > 80 ? {\n            position: 'fixed',\n            backgroundColor: 'rgba(255,255,255,0.9)',\n            padding: \"15px 0\",\n            top: 0\n          } : {\n            position: 'absolute',\n          }}>\n          <Input\n            style={{ maxWidth: '300px', flex: 1 }}\n            placeholder=\"搜索\"\n            onKeyUp={e => {\n              if (e.keyCode === 13) setSearch(e.target.value)\n              if (e.target.value === '') setSearch('')\n            }}\n          ></Input>\n          <Select\n            placeholder='分类'\n            value={classify}\n            style={{ marginLeft: 10, minWidth: 100 }}\n            onChange={(e) => setClassify(e)}>\n            <Select.Option value={''}>全部分类</Select.Option>\n            {directories.map((item, index) => (\n              <Select.Option value={item.name} key={index}>{item.name}</Select.Option>\n            ))}\n          </Select>\n        </div>\n        <div style={{ height: '60px' }}></div>\n      </div>\n    )\n  }\n  const renderPage = () => {\n    return (\n      <>\n        {list.map(({ node }) => {\n          console.log(node);\n          const title = node.frontmatter.title || node.fields.slug\n          return (\n            <article key={node.fields.slug} className={styles.list_item}>\n              <header>\n                <h3>\n                  <Link style={{ boxShadow: `none` }} to={node.fields.slug}>\n                    {title}\n                  </Link>\n                </h3>\n                <small>{node.frontmatter.date}</small>\n              </header>\n              <section>\n                <p\n                  dangerouslySetInnerHTML={{\n                    __html: node.frontmatter.description || node.excerpt,\n                  }}\n                />\n              </section>\n            </article>\n          )\n        })}\n      </>\n    )\n\n  }\n  return (\n    <Layout location={location} title={siteTitle}>\n      {renderSearch()}\n      {renderPage()}\n      <Pagination\n        style={{ margin: '10px 0' }}\n        current={current}\n        pageSize={pageSize}\n        total={totalList.length}\n        onChange={e => setCurrent(e)} />\n    </Layout >\n  )\n}\nexport default BlogIndex\nexport const pageQuery = graphql`\n  query {\n    site {\n      siteMetadata {\n        title\n      }\n    }\n    allDirectory(filter: {name: {nin: [\"blog\",\"assets\",\"images\",\"files\"]}}) {\n      nodes {\n        absolutePath\n        name\n      }\n    }\n    allMarkdownRemark(sort: { fields: [frontmatter___date], order: DESC }) {\n      edges {\n        node {\n          excerpt\n          fields {\n            slug\n          }\n          frontmatter {\n            date(formatString: \"MMMM DD, YYYY\")\n            title\n            description\n          }\n          parent {\n            ... on File {\n              relativeDirectory\n            }\n          }\n        }\n      }\n    }\n  }\n`\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"search_box\":\"index-module--search_box--1gSNb\",\"home_box\":\"index-module--home_box--3SWmn\",\"list_item\":\"index-module--list_item--h3Xdi\"};"],"sourceRoot":""}